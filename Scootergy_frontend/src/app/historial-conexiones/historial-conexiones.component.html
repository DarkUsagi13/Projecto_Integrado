<app-plantilla-perfil>
  <div class="container slide-in-right">
    <h1 class="text-center p-5">Historial de conexiones</h1>
    <div>
      <div>
        <form [formGroup]="valoresForm" class="row align-items-center">
          <div class="form-group col-3 p-4">
            <label for="filtros">Filtrar por:</label>
            <select id="filtros" formControlName="filtros" class="form-control" (click)="aplicarFiltroOrdenamiento()">
              <option *ngFor="let valor of filtros | keyvalue" [ngValue]="valor.key">{{valor.value}}</option>
            </select>
          </div>
          <div class="form-group col-2 p-4">
            <label for="orden">Ordenar por:</label>
            <select id="orden" formControlName="orden" class="form-control" (change)="aplicarFiltroOrdenamiento()">
              <option selected>Ascendente</option>
              <option>Descendente</option>
            </select>
          </div>
        </form>
      </div>
      <table class="table text-center">
        <thead>
        <tr>
          <th scope="col">Patinete</th>
          <th scope="col">Estación</th>
          <th scope="col">Consumo</th>
          <th scope="col">Hora de conexión</th>
          <th scope="col">Hora de desconexión</th>
          <th scope="col">Importe</th>
          <th scope="col">Detalles</th>
        </tr>
        </thead>
        <ng-container *ngIf="conexionesPaginadas.length > 0">
          <tbody *ngFor="let conexion of conexionesPaginadas">
          <tr>
            <ng-container *ngIf="conexion.finalizada">
              <td>{{conexion.patineteNombre}}</td>
              <td>{{conexion.datosPuesto.datosEstacion.nombre}}, puesto: {{conexion.datosPuesto.id}}</td>
              <td>{{conexion.consumo}}</td>
              <td>{{conexion.horaConexion | date: 'dd/MM/yyyy HH:mm'}}</td>
              <td>{{conexion.horaDesconexion | date: 'dd/MM/yyyy HH:mm'}}</td>
              <td>{{conexion.monto}}€</td>
              <td class="d-flex justify-content-center align-items-center">
                <a class="btn btn-link mr-1" title="Detalles de la conexión" [routerLink]="['detalles_conexion/', conexion.id]">
                  <span class="material-symbols-outlined">page_info</span>
                </a>
              </td>
            </ng-container>
          </tr>
          </tbody>
        </ng-container>
      </table>
    </div>
    <div class="text-center">
      <ngb-pagination
        [(page)]="paginaActual"
        [pageSize]="itemsPorPagina"
        [collectionSize]="totalConexiones"
        (pageChange)="realizarPaginacion()"
      ></ngb-pagination>
    </div>
  </div>
</app-plantilla-perfil>
